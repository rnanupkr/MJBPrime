<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MJB Prime Vikas Samiti - Flat Statement</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f8f9fa; }
    h1 { text-align: center; color: #2c3e50; }
    .search-box { text-align: center; margin: 20px; }
    input[type="text"] { padding: 6px; font-size: 14px; width: 180px; }
    button { padding: 6px 12px; font-size: 14px; margin-left: 5px; cursor: pointer; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; background: white; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #007bff; color: white; }
    tr:nth-child(even) { background: #f2f2f2; }
    #result { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>MJB Prime Vikas Samiti</h1>

  <div class="search-box">
    <label for="flatNo">Enter Flat No: </label>
    <input type="text" id="flatNo" placeholder="e.g., 101">
    <button onclick="searchFlat()">Submit</button>
  </div>

  <div id="result"></div>

  <script>
    let data = [];

    // Load JSON dynamically
    fetch("https://raw.githubusercontent.com/rnanupkr/MJBPrime/main/flats.json")
      .then(response => response.text()) // GitHub serves JSON as text/plain
      .then(text => {
        try {
          data = JSON.parse(text);
          console.log("✅ JSON loaded:", data.length, "records");
        } catch (e) {
          console.error("❌ JSON parse error:", e);
          document.getElementById("result").innerHTML = "<p>Invalid JSON format.</p>";
        }
      })
      .catch(err => {
        console.error("❌ Error loading flats.json:", err);
        document.getElementById("result").innerHTML = "<p>Error loading data.</p>";
      });

    function searchFlat() {
      const flatNo = document.getElementById("flatNo").value.trim();
      const resultDiv = document.getElementById("result");

      if (!flatNo) {
        resultDiv.innerHTML = "<p style='color:red;'>Please enter a Flat No.</p>";
        return;
      }

      // Match on "Flat No" field
      const record = data.find(item => String(item["Flat No"]).trim() === flatNo);

      if (record) {
        resultDiv.innerHTML = `
          <table>
            <tr>
              <th>Flat No</th>
              <th>Name</th>
              <th>Month</th>
              <th>Year</th>
              <th>Bill Amount</th>
              <th>Received Amount</th>
              <th>Mode</th>
              <th>Pending Amount</th>
            </tr>
            <tr>
              <td>${record["Flat No"]}</td>
              <td>${record["Name"]}</td>
              <td>${record["Month"]}</td>
              <td>${record["Year"]}</td>
              <td>${record["Bill Amount"]}</td>
              <td>${record["Received Amount"]}</td>
              <td>${record["Mode"]}</td>
              <td>${record["Pending Amount"]}</td>
            </tr>
          </table>
        `;
      } else {
        resultDiv.innerHTML = `<p style="color:red;">No record found for Flat No ${flatNo}</p>`;
      }
    }
  </script>
</body>
</html>
